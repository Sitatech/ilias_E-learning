function cleanElements(a){textinputs=YAHOO.util.Dom.getElementsBy(function(b){return(b.type=="text")?true:false},"input",a);for(i=0;i<textinputs.length;i++){textinputs[i].value=""}textareas=YAHOO.util.Dom.getElementsBy(function(b){return true},"textarea",a);for(i=0;i<textareas.length;i++){children=textareas[i].childNodes;for(j=0;j<children.length;j++){textareas[i].removeChild(children[j])}}}function reindexRows(b,a){rows=YAHOO.util.Dom.getElementsBy(function(c){return true},"tr",b);for(i=0;i<rows.length;i++){YAHOO.util.Dom.removeClass(rows[i],"odd");YAHOO.util.Dom.removeClass(rows[i],"even");YAHOO.util.Dom.removeClass(rows[i],"first");YAHOO.util.Dom.removeClass(rows[i],"last");alter=(i%2==0)?"even":"odd";YAHOO.util.Dom.addClass(rows[i],alter);add=(i==0)?"first":((i==rows.length-1)?"last":"");if(add.length>0){YAHOO.util.Dom.addClass(rows[i],add)}textinputs=YAHOO.util.Dom.getElementsBy(function(c){return(c.type=="text")?true:false},"input",rows[i]);for(j=0;j<textinputs.length;j++){if(textinputs[j].id.indexOf("[answer]")>=0){textinputs[j].id=a+"[answer]["+i+"]";textinputs[j].name=a+"[answer]["+i+"]"}else{if(textinputs[j].id.indexOf("[points]")>=0){textinputs[j].id=a+"[points]["+i+"]";textinputs[j].name=a+"[points]["+i+"]"}}}textareas=YAHOO.util.Dom.getElementsBy(function(c){return true},"textarea",rows[i]);for(j=0;j<textareas.length;j++){textareas[j].id=a+"[answer]["+i+"]";textareas[j].name=a+"[answer]["+i+"]"}addbuttons=YAHOO.util.Dom.getElementsBy(function(c){return(c.className=="answerwizard_add")?true:false},"input",rows[i]);for(j=0;j<addbuttons.length;j++){addbuttons[j].id="add_"+a+"["+i+"]";addbuttons[j].name="cmd[add"+a+"]["+i+"]";YAHOO.util.Event.addListener(addbuttons[j],"click",addRow)}removebuttons=YAHOO.util.Dom.getElementsBy(function(c){return(c.className=="answerwizard_remove")?true:false},"input",rows[i]);for(j=0;j<removebuttons.length;j++){removebuttons[j].id="remove_"+a+"["+i+"]";removebuttons[j].name="cmd[remove"+a+"]["+i+"]";YAHOO.util.Event.addListener(removebuttons[j],"click",removeRow)}upbuttons=YAHOO.util.Dom.getElementsBy(function(c){return(c.className=="answerwizard_up")?true:false},"input",rows[i]);if(upbuttons.length>0){for(j=0;j<upbuttons.length;j++){upbuttons[j].id="up_"+a+"["+i+"]";upbuttons[j].name="cmd[up"+a+"]["+i+"]";YAHOO.util.Event.addListener(upbuttons[j],"click",moveRowUp)}}downbuttons=YAHOO.util.Dom.getElementsBy(function(c){return(c.className=="answerwizard_down")?true:false},"input",rows[i]);if(downbuttons.length>0){for(j=0;j<downbuttons.length;j++){downbuttons[j].id="down_"+a+"["+i+"]";downbuttons[j].name="cmd[down"+a+"]["+i+"]";YAHOO.util.Event.addListener(downbuttons[j],"click",moveRowDown)}}}}function removeListeners(d){var a=YAHOO.util.Dom.getElementsBy(function(f){return(f.className=="answerwizard_add")?true:false},"input",d);for(i=0;i<a.length;i++){YAHOO.util.Event.purgeElement(a[i])}var c=YAHOO.util.Dom.getElementsBy(function(f){return(f.className=="answerwizard_remove")?true:false},"input",d);for(i=0;i<c.length;i++){YAHOO.util.Event.purgeElement(c[i])}var b=YAHOO.util.Dom.getElementsBy(function(f){return(f.className=="answerwizard_up")?true:false},"input",d);for(i=0;i<b.length;i++){YAHOO.util.Event.purgeElement(b[i])}var e=YAHOO.util.Dom.getElementsBy(function(f){return(f.className=="answerwizard_down")?true:false},"input",d);for(i=0;i<e.length;i++){YAHOO.util.Event.purgeElement(e[i])}}function addRow(c,b){var d=this.parentNode.parentNode;var a=d.parentNode;removeListeners(a);rowclone=d.cloneNode(true);cleanElements(rowclone);trs=YAHOO.util.Dom.getElementsBy(function(e){return true},"tr",a);parentindex=0;for(i=0;i<trs.length;i++){if(trs[i]==d){parentindex=i+1}}if(parentindex==trs.length){a.appendChild(rowclone)}else{a.insertBefore(rowclone,trs[parentindex])}reindexRows(a,a.parentNode.parentNode.id);textinputs=YAHOO.util.Dom.getElementsBy(function(e){return(e.type=="text")?true:false},"input",rowclone);textinputs[0].focus();return false}function removeRow(c,b){var d=this.parentNode.parentNode;var a=d.parentNode;trs=YAHOO.util.Dom.getElementsBy(function(e){return true},"tr",a);if(trs.length==1){cleanElements(trs[0])}else{a.removeChild(d);removeListeners(a);reindexRows(a,a.parentNode.parentNode.id)}}function moveRowUp(c,b){var d=this.parentNode.parentNode;var a=d.parentNode;rows=YAHOO.util.Dom.getElementsBy(function(e){return true},"tr",a);foundindex=0;for(i=0;i<rows.length;i++){if(rows[i]==d){foundindex=i}}if(foundindex>0){removeListeners(a);temp=rows[foundindex-1];rows[foundindex-1]=d;rows[foundindex]=temp;children=a.childNodes;for(j=0;j<children.length;j++){a.removeChild(children[j])}for(j=0;j<rows.length;j++){a.appendChild(rows[j])}reindexRows(a,a.parentNode.parentNode.id)}}function moveRowDown(c,b){var d=this.parentNode.parentNode;var a=d.parentNode;rows=YAHOO.util.Dom.getElementsBy(function(e){return true},"tr",a);foundindex=0;for(i=0;i<rows.length;i++){if(rows[i]==d){foundindex=i}}if(foundindex<rows.length-1){removeListeners(a);temp=rows[foundindex+1];rows[foundindex+1]=d;rows[foundindex]=temp;children=a.childNodes;for(j=0;j<children.length;j++){a.removeChild(children[j])}for(j=0;j<rows.length;j++){a.appendChild(rows[j])}reindexRows(a,a.parentNode.parentNode.id)}}function skipJS(a){return true}function answerWizardEvents(a){addbuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_add");tbody=addbuttons[0].parentNode.parentNode.parentNode;tas=YAHOO.util.Dom.getElementsBy(function(b){return true},"textarea",tbody);if(typeof tinyMCE=="undefined"||tas.length==0){for(i=0;i<addbuttons.length;i++){button=addbuttons[i];YAHOO.util.Event.addListener(button,"click",addRow)}removebuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_remove");for(i=0;i<removebuttons.length;i++){button=removebuttons[i];YAHOO.util.Event.addListener(button,"click",removeRow)}upbuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_up");for(i=0;i<upbuttons.length;i++){button=upbuttons[i];YAHOO.util.Event.addListener(button,"click",moveRowUp)}downbuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_down");for(i=0;i<downbuttons.length;i++){button=downbuttons[i];YAHOO.util.Event.addListener(button,"click",moveRowDown)}}else{for(i=0;i<addbuttons.length;i++){button=addbuttons[i];button.onclick=skipJS}removebuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_remove");for(i=0;i<removebuttons.length;i++){button=removebuttons[i];button.onclick=skipJS}upbuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_up");for(i=0;i<upbuttons.length;i++){button=upbuttons[i];button.onclick=skipJS}downbuttons=YAHOO.util.Dom.getElementsByClassName("answerwizard_down");for(i=0;i<downbuttons.length;i++){button=downbuttons[i];button.onclick=skipJS}}}YAHOO.util.Event.onDOMReady(answerWizardEvents);